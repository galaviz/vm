function Tagger(e,t,o,s,i,n){this.feedback=document.getElementById(t),this.feedback.style.position="absolute",this.element=document.getElementById(e),this.element.style.position="relative",this.isMouseDown=!1,this.element.onmousedown=this.wrap(this,"mouseDown"),this.position_x_field=document.getElementById(o),this.position_y_field=document.getElementById(s),this.width_field=document.getElementById(i),this.height_field=document.getElementById(n)}function fitToBounds(e,t,o){return t>e?t:e>o?o:e}function findPos(e){var t=curtop=0;if(e.offsetParent){do t+=e.offsetLeft,curtop+=e.offsetTop;while(e=e.offsetParent);return[t,curtop]}}Tagger.prototype.wrap=function(e,t){return function(o){e[t](o)}},Tagger.prototype.mouseDown=function(e){console.log("Mouse Down"),this.oldMoveHandler=document.body.onmousemove,document.onmousemove=this.wrap(this,"mouseMove"),this.oldUpHandler=document.body.onemouseup,document.onmouseup=this.wrap(this,"mouseUp"),this.oldX=e.pageX,this.oldY=e.pageY,this.isMouseDown=!0},Tagger.prototype.mouseMove=function(e){if(this.isMouseDown){var t=findPos(this.element),o=t[0],s=t[1],i=this.element.offsetHeight,n=this.element.offsetWidth;this.newX=fitToBounds(e.pageX,o,o+n),this.newY=fitToBounds(e.pageY,s,s+i),this.feedback.style.width=Math.abs(this.newX-this.oldX)+"px",this.feedback.style.height=Math.abs(this.newY-this.oldY)+"px",this.feedback.style.left=Math.min(this.newX,this.oldX)-o+"px",this.feedback.style.top=Math.min(this.newY,this.oldY)-s+"px",this.updateFormFields()}},Tagger.prototype.updateFormFields=function(){this.position_x_field.value=parseInt(this.feedback.style.left),this.position_y_field.value=parseInt(this.feedback.style.top),this.width_field.value=parseInt(this.feedback.style.width),this.height_field.value=parseInt(this.feedback.style.height)},Tagger.prototype.mouseUp=function(){this.isMouseDown=!1,document.onmousemove=this.oldMoveHandler,document.onmouseup=this.oldUpHandler};